{% extends "Dashboard/base.html" %}
{% load static %}


{% block css %}
{% endblock %}


{% block extra_meta %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}


{% block title %}
    Dashboard
{% endblock %}

{% block content %}        



    <!-- content -->
        <div class="mt-3">
          <div class="mb-0">
            <div class=" row d-flex justify-content-center">
              <div href="" class=" btn btn-primary col-md-3  d-flex flex-column justify-content-center bgdash rounded-2 border border-2 border-light rounded-4">
                <h5>Orphan Analysis</h5>
                <h1 class="text-center mt-3">100</h1>
              </div>
              <div class=" col-md-2  d-flex flex-column justify-content-center bgdash rounded-2 border border-2 border-light rounded-4">
                <h5 class="pt-2 text-center">Gender <i class="txtColor icon fa-solid fa-venus-mars fs-5"></i></h5>
                <div class="row">
                  <div class="col-6 d-flex justify-content-center align-items-center">
                      <p class="m-1">Male</p>
                  </div>
                  <div class="col-6 d-flex justify-content-center align-items-center">
                      <span class="badge bg-success rounded-pill">55</span>
                  </div>
                  <div class="col-6 d-flex justify-content-center align-items-center">
                      <p class="m-1">Female</p>
                  </div>
                  <div class="col-6 d-flex justify-content-center align-items-center">
                      <span class="badge bg-danger rounded-pill">55</span>
                  </div>
                  <hr class="mb-1">
                  <div class="col-6 d-flex justify-content-center align-items-center">
                      <p class="m-1">Total</p>
                  </div>
                  <div class="col-6 d-flex justify-content-center align-items-center">
                      <span class="badge bg-secondary rounded-pill">110</span>
                  </div>
              </div>
              
              </div>
              <div class=" btn  btn-primary col-md-2  d-flex flex-column justify-content-center bgdash rounded-2 border border-2 border-light rounded-4">
                <a href="./intervention-health.html" class="text-decoration-none txtColor">
                  <h5 class="pt-2">Behavior <i class="txtColor icon fa-solid fa-heart-circle-exclamation fs-5"></i></h5>
                  <h1 class="text-center mt-3">100</h1>
                  <p>Needs Intervention</p>
                </a>
              </div>
              <div class=" btn  btn-primary col-md-2  d-flex flex-column justify-content-center bgdash rounded-2 border border-2 border-light rounded-4">
                <a href="./intervention-academics.html" class="text-decoration-none txtColor">
                  <h5 class="pt-2">Education <i class="txtColor icon fa-solid fa-building-circle-exclamation fs-5"></i></h5>
                  <h1 class="text-center mt-3">100</h1>
                  <p>Needs Intervention</p>
                </a>
              </div>
              <div class=" btn  btn-primary col-md-2  d-flex flex-column justify-content-center bgdash rounded-2 border border-2 border-light rounded-4">
                <a href="./intervention-behavior.html" class="text-decoration-none txtColor">
                  <h5 class="pt-2" >Behavior <i class="txtColor icon fa-solid fa-person-circle-exclamation fs-5"></i></h5>
                  <h1 class="text-center mt-3">100</h1>
                  <p>Needs Intervention</p>
                </a>
              </div>

            </div>
          </div>
        </div>
        
                
        <hr class="m-0 mt-0 w-100">
<!-- charts here -->
<!-- Charts section -->
<div class="container mt-0 mb-lg-5">
  <div class="row">
    <div class="col-md-4">
      <div id="sentimentsChartContainer" class="container mt-3 mb-0 justify-content-center align-items-center border border-2 rounded-2 d-flex p-0" onclick="window.location.href='./chart-sentiments.html';" style="height: 460px; flex-wrap: nowrap; flex-direction: column;">
        <h5 class="text-center ">Sentiments Chart</h5>
        <canvas id="sentimentsChart"></canvas>
      </div>
    </div>
    <div class="col-md-4">
      <div class="container mt-2 mb-0 justify-content-evenly align-items-center border border-2 rounded-2 d-flex flex-column  p-0" onclick="window.location.href='./chart-bmi.html';" style="height: 26.1h;">
        <h5 class="text-center">BMI Chart</h5>
        <canvas id="bmiChart"></canvas>
      </div>
      <div class="container mt-2 mb-0 justify-content-evenly align-items-center border border-2 rounded-2 d-flex flex-column  p-0" onclick="window.location.href='./chart-health.html';" style="height: 26.1h;">
        <h5 class="text-center">Health Chart</h5>
        <canvas id="healthChart"></canvas>
      </div>
    </div>
    <div class="col-md-4">
      <div class="container mt-2 mb-0 justify-content-evenly align-items-center border border-2 rounded-2 d-flex flex-column  p-0" onclick="window.location.href='./chart-age.html';"style="height: 26.1h;">
        <h5 class="text-center">Age Chart</h5>
        <canvas id="ageChart"></canvas>
      </div>
      <div class="container mt-2 mb-0 justify-content-evenly align-items-center border border-2 rounded-2 d-flex flex-column  p-0" onclick="window.location.href='./chart-academic.html';" style="height: 26.1h;">
        <h5 class="text-center">Academic Chart</h5>
        <canvas id="academicChart"></canvas>
      </div>
    </div>
  </div>
{% endblock %}


            {% block js%}
            <!-- for sentiment/behavior chart -->
            {{ sentiments|json_script:"sentiments-data" }}
            <script>
            fetch('/Dashboard/api/chart-sentiment/')
            .then(response => response.json())
            .then(sentimentData => {
                var ctx = document.getElementById('sentimentChart').getContext('2d');
                var myChart = new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: ['Positive', 'Negative', 'Neutral'],
                        datasets: [{
                            label: '# of Orphans',
                            // data: [10, 10, 20],
                            data: [sentimentData.positive, sentimentData.negative, sentimentData.neutral],
                            backgroundColor: ['rgba(255, 99, 132, 0.8)', 'rgba(54, 162, 235, 0.8)', 'rgba(255, 206, 86, 0.8)'],
                            borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                    }
                });
            });
            </script>
          
          <!-- for age distribution chart -->
          <script>
            document.addEventListener('DOMContentLoaded', function () {
              var ctx = document.getElementById('ageChart').getContext('2d');
              
              // Assuming male_age_data and female_age_data are lists of numbers
              var labels = ['0-10', '11-20', '21-30', '31-40'];
              var maleAgeData = {{ male_age_data|safe }};
              var femaleAgeData = {{ female_age_data|safe }};

              var ageData = {
                labels: labels,
                datasets: [{
                  label: 'Male',
                  data: maleAgeData,
                  backgroundColor: 'rgba(54, 162, 235, 0.8)',
                  borderColor: 'rgba(54, 162, 235, 1)',
                  borderWidth: 1
                }, {
                  label: 'Female',
                  data: femaleAgeData,
                  backgroundColor: 'rgba(255, 99, 132, 0.8)',
                  borderColor: 'rgba(255, 99, 132, 1)',
                  borderWidth: 1
                }]
              };

              new Chart(ctx, {
                type: 'bar',
                data: ageData,
                options: {
                  scales: {
                    y: {
                      beginAtZero: true
                    }
                  }
                }
              });
            });
          </script>

          <!-- for bmi chart -->
          {{ bmi_data|json_script:"bmi-data" }}
          <script type="text/javascript">
            const bmiDataElement = document.getElementById('bmi-data');
            // Renamed the variable to avoid conflicts
            const bmiChartData = JSON.parse(bmiDataElement.textContent);

            const chartData = {
                labels: ['Underweight', 'Normal', 'Overweight', 'Obesity'],
                datasets: [{
                    label: 'BMI Status',
                    data: bmiChartData, // Use the renamed variable here
                    backgroundColor: ['rgba(255, 99, 132, 0.8)', 'rgba(54, 162, 235, 0.8)', 'rgba(255, 206, 86, 0.8)', 'rgba(75, 192, 192, 0.8)'],
                    borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)'],
                    borderWidth: 1
                }]
            };

            var bmiChartCtx = document.getElementById('bmiChart').getContext('2d');
            var bmiChart = new Chart(bmiChartCtx, {
                type: 'bar',
                data: chartData
            });
          </script>


         <script>
          document.addEventListener('DOMContentLoaded', function () {
              const academicLabels = {{ academic_labels|safe }};
              const academicData = {{ academic_data|safe }};
              console.log(academicLabels, academicData);

              const academicChartData = {
                  labels: academicLabels,
                  datasets: [{
                      label: 'Academic Performance',
                      data: {{ academic_data|safe }}.map(Number),
                      backgroundColor: [
                          'rgba(255, 99, 132, 0.8)',
                          'rgba(255, 159, 64, 0.8)',
                          'rgba(255, 205, 86, 0.8)',
                          'rgba(75, 192, 192, 0.8)',
                      ],
                      borderColor: [
                          'rgba(255, 99, 132, 1)',
                          'rgba(255, 159, 64, 1)',
                          'rgba(255, 205, 86, 1)',
                          'rgba(75, 192, 192, 1)',
                      ],
                      borderWidth: 1
                  }]
              };

              const config = {
                  type: 'bar',
                  data: academicChartData,
                  options: {
                    plugins:{
                      scales: {
                          y: {
                              beginAtZero: true
                          }
                      },
                      tooltips: { // Customizing tooltips
                          enabled: true,
                          mode: 'index',
                          intersect: false,
                          callbacks: {
                              label: function(tooltipItem, data) {
                                  var label = data.datasets[tooltipItem.datasetIndex].label || '';
                                  if (label) {
                                      label += ': ';
                                  }
                                  label += tooltipItem.yLabel;
                                  return label;
                              }
                          }
                      }
                    }
                  },
              };

              var academicChartCtx = document.getElementById('academicChart').getContext('2d');
              var academicChart = new Chart(academicChartCtx, config);
          });
          </script>


            <script>  
              const healthData = {
                  labels: ['Normal', 'Sick', 'Admitted'],
                  datasets: [{
                      label: 'Health Status',
                      data: ['5', '2', '1'], // Updated with normal, sick, admitted
                      backgroundColor: ['rgba(255, 99, 132, 0.8)', 'rgba(54, 162, 235, 0.8)', 'rgba(255, 206, 86, 0.8)'],
                      borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)'],
                      borderWidth: 1
                  }]
              };
            
            
              // Create Health chart
              var healthChartCtx = document.getElementById('healthChart').getContext('2d');
              var healthChart = new Chart(healthChartCtx, {
                  type: 'bar',
                  data: healthData
              });
            </script>  



{% endblock %}

